<!DOCTYPE html>
<html lang="kn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡≤ï‡≤®‡≥ç‡≤®‡≤° ‡≤¨‡≥à‡≤¨‡≤≤‡≥ç ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body,html{height:100%;width:100%;font-family:'Segoe UI',sans-serif;overflow:hidden;background:#f1f1f1;}
  .page{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;transition:opacity 1s, transform 1s;}
  .hidden{opacity:0;pointer-events:none;transform:scale(0.95);}
  #splash{background:linear-gradient(135deg,#6a0dad,#ff6b6b);color:#fff;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;}
  #splash h1{font-size:3em;text-align:center;animation:gradientText 5s ease infinite;background:linear-gradient(90deg,#fff,#ffd700,#fff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
  #splash p{margin-top:20px;font-size:1.2em;opacity:0.8;}
  @keyframes gradientText{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}

  #home{background:linear-gradient(120deg,#c1f0f6,#fef9f0);width:100%;height:100%;padding:20px;overflow:auto;}
  .app-container{width:90%;max-width:450px;background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);border-radius:30px;padding:30px;text-align:center;box-shadow:0 12px 30px rgba(0,0,0,0.2);}
  h1,h2{color:#fff;margin-bottom:15px;}
  h1{font-size:1.5em;} h2{font-size:1em;}
  canvas{width:100%;border-radius:20px;margin-bottom:20px;box-shadow:0 10px 25px rgba(0,0,0,0.3);}
  .buttons{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin-bottom:15px;}
  button{padding:14px 22px;border-radius:12px;border:none;font-size:1em;cursor:pointer;color:#fff;background:linear-gradient(90deg,#6a0dad,#ff6b6b);box-shadow:0 6px 15px rgba(0,0,0,0.3);transition:transform 0.2s, box-shadow 0.2s;}
  button:hover{transform:translateY(-2px);box-shadow:0 10px 20px rgba(0,0,0,0.4);background:linear-gradient(90deg,#ff6b6b,#6a0dad);}
  .banner-ads{display:flex;flex-direction:column;align-items:center;width:100%;margin-top:15px;}
  .banner-ads > div{margin:10px 0;text-align:center;}
</style>
</head>
<body>

<!-- Splash -->
<div id="splash" class="page">
  <h1>‡≤ï‡≤®‡≥ç‡≤®‡≤° ‡≤¨‡≥à‡≤¨‡≤≤‡≥ç ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å</h1>
  <p>‡≤™‡≥ç‡≤∞‡≤§‡≤ø‡≤¶‡≤ø‡≤®‡≤µ‡≥Ç ‡≤™‡≥ç‡≤∞‡≥á‡≤∞‡≤£‡≥Ü‡≤Ø ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï‡≤ó‡≤≥‡≥Å</p>
</div>

<!-- Home -->
<div id="home" class="page hidden">
  <div class="app-container">
    <h1 id="verse-title">‡≤¨‡≥à‡≤¨‡≤≤‡≥ç ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï</h1>
    <h2 id="verse-subtitle">‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï ‡≤≤‡≥ã‡≤°‡≥ç ‡≤Ü‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü...</h2>
    <canvas id="verse-canvas" width="450" height="450"></canvas>
    <div class="buttons">
      <button onclick="generateVerseImage()">üîÑ ‡≤π‡≥ä‡≤∏ ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï</button>
      <button onclick="downloadImage()">‚¨áÔ∏è ‡≤°‡≥å‡≤®‡≥ç‚Äå‡≤≤‡≥ã‡≤°‡≥ç</button>
      <button onclick="shareImage()">üì§ ‡≤π‡≤Ç‡≤ö‡≤ø‡≤ï‡≥ä‡≤≥‡≥ç‡≤≥‡≤ø</button>
    </div>

    <!-- Banner Ads -->
    <div class="banner-ads">
      <div class="banner-classic">
        <script type="text/javascript">
          atOptions = {
            'key' : '3fcf2237ab3c7796108f33a1522ae5f5',
            'format' : 'iframe',
            'height' : 60,
            'width' : 468,
            'params' : {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/3fcf2237ab3c7796108f33a1522ae5f5/invoke.js"></script>
      </div>
      <div class="banner-native">
        <script async data-cfasync="false" src="//pl27523297.effectivecpmrate.com/4a6d683f02e3d8f3a07f228ed76f271c/invoke.js"></script>
        <div id="container-4a6d683f02e3d8f3a07f228ed76f271c"></div>
      </div>
    </div>
  </div>
</div>

<script>
const canvas=document.getElementById("verse-canvas");
const ctx=canvas.getContext("2d");
let verses=[];
let currentVerse="";

// Splash -> Home
setTimeout(()=>{document.getElementById('splash').classList.add('hidden'); document.getElementById('home').classList.remove('hidden'); generateVerseImage();},2500);

// Load local JSON (kn_kjv.json) on GitHub Pages
async function loadVerses(){
  try{
    const res = await fetch("kn_kjv.json");
    verses = await res.json();
  }catch(e){
    console.error("Failed to load Kannada Bible:",e);
    verses=[{"text":"‡≤∏‡≤æ‡≤Æ‡≤æ‡≤®‡≥ç‡≤Ø ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï","reference":"Genesis 1:1"}];
  }
}

function wrapTextCentered(ctx,text,x,y,maxWidth,lineHeight){
  const words=text.split(" "); let line=""; const lines=[];
  for(let n=0;n<words.length;n++){
    const testLine=line+words[n]+" ";
    const metrics=ctx.measureText(testLine);
    if(metrics.width>maxWidth&&n>0){lines.push(line);line=words[n]+" ";} else{line=testLine;}
  }
  lines.push(line);
  const totalHeight=lines.length*lineHeight;
  let startY=y-totalHeight/2;
  for(let i=0;i<lines.length;i++){ctx.fillText(lines[i],x,startY+i*lineHeight);}
}

function getRandomVerse(){if(verses.length===0) return {"text":"‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤","reference":""}; return verses[Math.floor(Math.random()*verses.length)];}
function getRandomImage(){const images=["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg","7.jpg","8.jpg","9.jpg","10.jpg"]; return images[Math.floor(Math.random()*images.length)];}

async function generateVerseImage(){
  if(verses.length===0) await loadVerses();
  const verse=getRandomVerse();
  currentVerse=`${verse.text} ‚Äî ${verse.reference}`;
  document.getElementById("verse-title").innerText="‡≤¨‡≥à‡≤¨‡≤≤‡≥ç ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï";
  document.getElementById("verse-subtitle").innerText=verse.reference;

  ctx.fillStyle="#ddd"; ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#333"; ctx.font="20px Segoe UI"; ctx.fillText("Loading...",150,220);

  const img=new Image();
  img.src=getRandomImage();
  img.onload=()=>{
    ctx.drawImage(img,0,0,canvas.width,canvas.height);
    ctx.fillStyle="rgba(0,0,0,0.35)"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#fff"; ctx.textAlign="center"; ctx.textBaseline="middle"; ctx.font="bold 24px Segoe UI";
    wrapTextCentered(ctx,currentVerse,canvas.width/2,canvas.height/2,canvas.width-40,32);
  }
}

function downloadImage(){
  const link=document.createElement("a");
  link.download="verse-image.png";
  link.href=canvas.toDataURL("image/png");
  document.body.appendChild(link); link.click(); document.body.removeChild(link);
}

async function shareImage(){
  if(navigator.share && navigator.canShare){
    canvas.toBlob(async(blob)=>{
      const file=new File([blob],"verse.png",{type:"image/png"});
      if(navigator.canShare({files:[file]})){
        try{await navigator.share({files:[file],title:"‡≤¨‡≥à‡≤¨‡≤≤‡≥ç ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï",text:"‡≤à ‡≤∂‡≥ç‡≤≤‡≥ã‡≤ï‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤®‡≥ã‡≤°‡≤ø!"});}catch(err){console.log("Share cancelled");}
      }else{alert("Sharing not supported on this device.");}
    });
  }else{alert("Sharing not supported on this browser.");}
}
</script>
</body>
</html>
